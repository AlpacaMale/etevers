{% extends "layout.html" %} {% block body %}
<main class="container" style="width: 80%">
  <div class="p-5"></div>
</main>
<main class="container" style="width: 80%">
  <div class="p-5 pt-0">
    <div class="shadow-sm bg-body-tertiary rounded clearfix" style="padding: 80px 100px">
      <div class="carousel-item active">
        <div class="col text-center rounded bg-body-secondary" style="padding: 180px">
          <p class="text-body-dark text-center fw-bold" style="font-size: 18px">"AIê°€ ë‹¹ì‹ ì˜ ê±´ê°• ì •ë³´ì™€ ì„ í˜¸ë„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì ì˜ ì‹ë‹¨ì„ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤. ğŸ’ª"</p>
          <div class="spinner-border text-secondary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
<script>
  function checkStatus(taskId) {
    fetch(`/task-status/${taskId}`)
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok " + response.statusText);
        }
        return response.json();
      })
      .then((data) => {
        console.log(data); // ìƒíƒœ í™•ì¸ì„ ìœ„í•œ ë¡œê·¸ ì¶œë ¥
        if (data.status === "complete") {
          window.location.href = "/main"; // ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
        } else if (data.status === "error") {
          window.location.href = `/error/${taskId}`;
        } else {
          setTimeout(() => checkStatus(taskId), 1000); // ì‘ì—…ì´ ì§„í–‰ ì¤‘ì´ë©´ 1ì´ˆ í›„ ë‹¤ì‹œ í™•ì¸
        }
      })
      .catch((error) => {
        console.error("Error checking task status:", error);
        document.getElementById("status").innerText = "Error checking task status. Please try again.";
      });
  }

  window.onload = function () {
    const taskId = "{{ task_id }}";
    console.log(`Checking status for task: ${taskId}`); // ì¶”ê°€ëœ ë””ë²„ê·¸ ë¡œê·¸
    checkStatus(taskId);
  };
</script>
{% endblock %}
